# 근궤적 분석의 규칙과 응용

## 1. 근궤적의 기본 규칙

근궤적(Root Locus)은 제어 시스템의 이득 K가 0에서 무한대로 변화함에 따라 폐루프 시스템의 극점이 어떻게 이동하는지 보여주는 그래픽 방법입니다. 이를 통해 시스템의 안정성과 응답 특성을 분석할 수 있습니다.

### 규칙 1: 시작점과 끝점

근궤적은 개루프 전달함수의 극점(K=0)에서 시작하여 개루프 전달함수의 영점(K=∞)에서 끝납니다. 이는 개루프 시스템의 특성방정식 1+K·G(s)·H(s)=0을 만족하는 s의 집합입니다.

- n개의 극점과 m개의 영점을 가진 시스템의 경우:
  - n개의 분기가 개루프 극점에서 시작
  - m개의 분기가 유한 영점에서 끝남
  - (n-m)개의 분기가 무한 영점으로 향함

### 규칙 2: 대칭성

근궤적은 s-평면에서 실수축에 대해 대칭입니다. 이는 특성방정식의 계수가 실수이기 때문에 복소근이 항상 켤레 쌍으로 나타나기 때문입니다.

### 규칙 3: 실수축 구간

실수축 상의 점이 근궤적에 포함되는 조건은 그 점의 오른쪽에 있는 개루프 극점과 영점의 총 개수가 홀수인 경우입니다. 이를 통해 근궤적이 실수축의 어느 부분을 따라 이동하는지 파악할 수 있습니다.

### 규칙 4: 점근선

K가 매우 큰 값으로 접근할 때, 무한대로 향하는 (n-m)개의 근궤적 분기는 특정 점근선을 따라 움직입니다.

1) 점근선의 중심점(centroid):
```
σₐ = (Σ극점 - Σ영점) / (극점 수 - 영점 수)
```

2) 점근선의 각도:
```
φₐ = (180° + 360°k) / (n-m)   (k = 0, 1, 2, ..., n-m-1)
```

여기서:
- n은 유한 극점의 개수
- m은 유한 영점의 개수

### 규칙 5: 이탈각과 도착각

복소 극점이나 영점에서의 이탈각(departure angle)이나 도착각(arrival angle)은 각도 조건을 이용하여 계산할 수 있습니다.

**이탈각의 계산법 (극점에서):**
```
θ_dep = 180° - (다른 모든 극점으로부터의 각도 합) + (모든 영점으로부터의 각도 합)
```

**도착각의 계산법 (영점에서):**
```
θ_arr = 0° - (모든 극점으로부터의 각도 합) + (다른 모든 영점으로부터의 각도 합) + 180°
```

이 규칙은 근궤적이 복소 극점에서 이탈하거나 복소 영점에 도착할 때의 방향을 결정하는 데 중요합니다.

### 규칙 6: 분기점 (Breakaway & Break-in Points)

분기점은 근궤적이 실수축을 떠나거나(breakaway) 실수축으로 들어오는(break-in) 지점입니다. 이 점들은 다음 조건을 만족합니다:

```
dK/ds = 0   (s = σ일 때)
```

여기서 K(s)는 특성방정식에서 K에 대한 s의 함수입니다:
```
K(s) = -1/[G(s)H(s)]
```

## 2. 근궤적 활용 예시

### 예시 1: 테스트 포인트의 근궤적 판별

복소평면상의 테스트 포인트가 근궤적에 속하는지 확인하려면 각도 조건을 사용합니다:

```
∠G(s)H(s) = 180° + 360°k   (k = 0, ±1, ±2, ...)
```

실제로는 다음과 같이 계산합니다:
```
∠G(s)H(s) = (영점에서 테스트 포인트까지의 각도 합) - (극점에서 테스트 포인트까지의 각도 합) = 180° + 360°k
```

각도가 180°(또는 -180°, 540° 등)이면 테스트 포인트는 근궤적에 속합니다.

### 예시 2: 점근선 분석

시스템 L(s) = K/(s(s²+8s+12)) = K/(s(s+4+j4)(s+4-j4))의 근궤적을 그릴 때:

1. 극점 위치: 0, -4+j4, -4-j4 (총 3개)
2. 영점: 없음 (m=0)
3. 점근선 중심:
   ```
   σₐ = (0 + (-4+j4) + (-4-j4)) / 3 = -8/3 = -2.67
   ```
4. 점근선 각도:
   ```
   φₐ = (180° + 360°k) / 3
   k=0 → φₐ = 60°
   k=1 → φₐ = 180°
   k=2 → φₐ = 300°
   ```

즉, 점근선은 -2.67을 중심으로 60°, 180°, 300° 방향으로 향합니다.

### 예시 3: 이탈각 계산

복소 극점 -4+j4에서의 이탈각을 계산하면:
```
θ_dep = 180° - (∠[s-(-4-j4)] + ∠[s-0]) = 180° - (-90° + 0°) = -90° = -90° - 135° = -45°
```

이는 극점 -4+j4에서 근궤적이 -45° 방향으로 이탈함을 의미합니다.

### 예시 4: 분기점 계산

시스템 L(s) = K(s-2)(s-5)/((s+1)(s+2))의 분기점을 찾기 위해:

1. K(s) 계산: K(s) = -(s+1)(s+2)/((s-2)(s-5))
2. dK(s)/ds = 0 설정하여 방정식 풀기:
   ```
   d/ds[-(s+1)(s+2)/((s-2)(s-5))] = 0
   ```
3. 해를 구하면: s = -1.45 (breakaway point), s = 3.82 (break-in point)

이 분기점들은 근궤적이 실수축을 떠나거나 들어오는 위치를 나타냅니다.

### 예시 5: 특정 감쇠비를 갖는 시스템 설계

다음 시스템을 고려합니다:
```
G(s) = (s+2)/(s(s+1)(s+2)(s+4))
```

이 시스템이 특정 감쇠비(ζ)를 갖도록 이득 K를 설정하려면:

1. 원하는 감쇠비에 해당하는 s-평면 상의 직선을 그립니다 (예: ζ=0.5는 60° 직선)
2. 근궤적과 이 직선의 교점을 찾습니다
3. 이 교점에서의 K 값을 계산합니다:
   ```
   K = 1/|G(s)H(s)|
   ```

## 3. 로켓 위치 제어 시스템 문제 해석

로켓의 위치 제어 시스템에서 다음을 고려합니다:

### (a) 리드 보상기(Lead Compensator) 안정성 분석

센서가 단위 전달함수를 가지고 리드 보상기가 H(s) = K(s+3)/(s+6)인 경우 시스템 안정성 확인:

1. 플랜트가 1/s²인 시스템에서는 PD 제어기 사용이 필요합니다.
2. 리드 보상기 사용으로 개루프 전달함수: L(s) = K(s+3)/(s²(s+6))
3. 근궤적 분석 결과, 모든 K 값에 대해 폐루프 극점이 왼쪽 반평면에 존재하므로 시스템은 안정합니다.

### (b) 최적 이득 값 계산

센서가 시간 상수 0.1초와 단위 DC 이득을 가진 단일 극점 시스템으로 모델링되고, PD 제어기 H(s) = K(s+1)일 때:

1. 개루프 전달함수: L(s) = K(s+1)/(s²(0.1s+1)) = 10K(s+1)/(s²(s+10))
2. 점근선 계산: 
   ```
   σₐ = (-10 + 1) / 2 = -4.5
   φₐ = ±90°
   ```
3. 분기점 분석을 통해 s = -4와 s = -5/2에서 각각 breakaway와 break-in 지점을 찾습니다.
4. s = 2.5일 때의 K 값 계산:
   ```
   K = |s²(s+10)/(10(s+1))|_{s=2.5} = (2.5)²(2.5+10)/(10(2.5+1)) = 3.125
   ```

이 이득 값(K = 3.125)은 최대 감쇠비와 최소 정착 시간을 제공합니다.

## 4. 근궤적의 추가 특성 및 응용

### 4.1 임계 이득(Critical Gain)

시스템이 임계적으로 감쇠되는(단조롭게 수렴하는) 이득 값을 찾는 것은 중요합니다. 이는 근궤적이 실수축에서 복소축으로 분기하는 지점에서의 이득 값으로 구할 수 있습니다.

### 4.2 최대 오버슈트 제어

근궤적에서 특정 감쇠비(ζ)를 갖는 극점 위치를 선택하여 시스템의 최대 오버슈트를 제어할 수 있습니다:

- 감쇠비 ζ는 오버슈트 백분율과 관련: % Overshoot = 100e^(-πζ/√(1-ζ²))
- ζ = 0.7은 약 4.32%의 오버슈트를 제공
- ζ = 1.0은 오버슈트가 없음(임계 감쇠)

### 4.3 제어기 설계를 위한 근궤적 변형

PID 제어기나 리드/래그 보상기와 같은 제어기 설계 시, 근궤적의 모양을 변형하여 원하는 성능 특성을 얻을 수 있습니다:

- PD 제어기: 영점을 추가하여 근궤적을 왼쪽으로 이동
- PI 제어기: 원점에 극점, 실수축 상에 영점을 추가하여 정상 상태 오차 감소
- PID 제어기: PD와 PI의 조합으로 과도 응답과 정상 상태 성능 향상

### 4.4 복소 평면에서의 성능 영역

s-평면에서 다양한 성능 기준에 따른 영역을 정의할 수 있습니다:

1. 안정성 영역: 왼쪽 반평면(Re(s) < 0)
2. 감쇠비 영역: 복소평면에서 원점에서 방사되는 직선들 사이의 영역 (예: ζ > 0.7에 해당하는 영역)
3. 정착 시간 영역: 수직선 Re(s) < -4/Ts (Ts는 원하는 정착 시간)
4. 상승 시간 영역: 수평선 |Im(s)| < c/Tr (Tr은 원하는 상승 시간, c는 상수)

이러한 영역들을 조합하여 모든 폐루프 극점이 원하는 성능 영역 내에 위치하도록 제어기를 설계할 수 있습니다.

## 5. 근궤적 분석의 실용적 고려사항

### 5.1 모델링 불확실성

실제 시스템에는 항상 모델링 불확실성이 존재합니다. 근궤적 분석 시 이런 불확실성을 고려하는 방법:

- 여러 모델 매개변수에 대한 근궤적 플롯 비교
- 극점-영점 위치의 변화에 따른 민감도 분석
- 강인성을 위해 충분한 이득 및 위상 여유 확보

### 5.2 디지털 제어 시스템에서의 근궤적

연속 시간 시스템을 이산화할 때, 근궤적의 변화를 고려해야 합니다:

- s-평면에서 z-평면으로의 매핑: z = e^(sT) (T는 샘플링 시간)
- 안정성 영역이 단위 원 내부로 변환 (|z| < 1)
- 샘플링 시간에 따른 근궤적 왜곡 고려

### 5.3 비선형 시스템에서의 근궤적

비선형 시스템의 경우, 특정 작동점 주변에서 선형화하여 근궤적 분석을 적용할 수 있습니다:

- 여러 작동점에서의 근궤적 비교
- 이득 스케줄링 기법과 결합
- 비선형성이 강한 경우 추가적인 분석 방법 필요

## 6. 근궤적 설계 예시: 진자 제어 시스템

도립 진자(inverted pendulum) 시스템을 예로 들어 봅시다. 이 시스템의 간략화된 전달함수가 다음과 같다고 가정합니다:

```
G(s) = 1/(s²(s-a))
```

여기서 a > 0은 불안정한 극점을 나타냅니다.

### 설계 과정:

1. **시스템 분석**: 
   - 극점: 0(이중), a(불안정)
   - 영점: 없음
   - 시스템은 본질적으로 불안정

2. **PID 제어기 설계**:
   ```
   H(s) = K(s²+bs+c)/s
   ```

3. **근궤적 분석**:
   - 개루프 전달함수: L(s) = K(s²+bs+c)/(s³(s-a))
   - 원하는 폐루프 특성을 위한 b, c, K 값 결정
   - 점근선 분석을 통해 안정성 영역 확인
   - 분기점 분석으로 감쇠 특성 결정

4. **설계 검증**:
   - 선택된 매개변수에 대한 시간 응답 시뮬레이션
   - 강인성 테스트(모델 변화에 대한 성능 검증)

이러한 설계 과정을 통해 불안정한 시스템을 안정화하고 원하는 과도 응답 특성을 달성할 수 있습니다.