# 제어 시스템: 개방 루프와 폐루프 제어

## 1. 기본 개념 복습

### 동적 시스템(Dynamic System)
- **정의**: 과거/미래의 입력이 현재 출력에 영향을 주는 시스템 (메모리 존재)
- **특징**: 미분, 적분 등의 수학적 조작이 포함됨
- **예시**: RC 회로, 스프링-댐퍼 시스템, 열역학 시스템

### 시스템 모델(System Model)
- **정의**: 시스템을 수식적으로 표현한 것
- **모델링 트레이드오프**:
  - **단순성(Simplicity)**: 복잡한 모델을 간단화하면 오차가 증가하지만 계산이 용이함
  - **정확성(Accuracy)**: 정확한 모델 구현은 오차가 감소하지만 연산 부담이 크고 시스템 전체가 무거워짐

### 제어(Control)
- **정의**: 어떻게든 원하는 결과를 얻어내는 방법
- **자동 제어(Automatic Control)**: 인간 없이 기계적/자동적으로 목표한 동작을 수행하는 제어

## 2. 개방 루프 제어(Open-loop Control)

### 정의
- **교과서 정의**: 출력을 활용하지 않는 제어로, 시스템의 모델에 완전히 의존
- **실용적 정의**: 입력을 넣고 출력을 관찰만 하는 제어 방식

### 개방 루프 제어 시스템 구성 요소
1. **원하는 것(Reference)**: 목표값 (예: LED ON/OFF)
2. **제어 대상(Plant)**: 제어하려는 시스템 (예: LED)
3. **제어기(Controller)**: 제어 대상을 원하는 대로 작동시키는 장치 (예: 마이크로프로세서)
4. **입력 필터(Input Filter)**: Reference를 Controller가 이해할 수 있는 신호로 변환 (예: 리모컨)
5. **외란(Disturbance)**: 제어 대상에 영향을 주는 원치 않는 요소 (예: 큰 저항)

### 개방 루프 제어 시스템 흐름도
```
Reference → [Input Filter] → [Controller] → [Actuator] → [Process] → Output
                                               ↑
                                               | 
                                          Disturbance
```

### 개방 루프 제어의 특징
- **장점**: 시스템이 간단하여 구현 시 가격면에서 이득
- **단점**: Plant를 정확히 알고 있어야 하며, 불규칙적인 외란에 대응할 수 없음

## 3. 폐루프 제어(Closed-loop Control)

### 정의
- **교과서 정의**: 센서에 의한 측정 신호와 기준 입력 신호 사이를 항상 비교하며, 그 오차를 줄이는 방향으로 시스템을 제어하는 동작
- **피드백 제어(Feedback Control)**: 폐루프 제어의 다른 이름

### 폐루프 제어 시스템 구성 요소
- **기준값(Reference)**: Output의 목표값
- **입력 필터(Input Filter)**: Reference를 Controller의 입력으로 사용하기 위해 신호를 전기적인 형태로 변환
- **제어기(Controller)**: Reference와 Output의 차이를 줄이는 시스템
- **Plant**: 제어의 대상이 되는 것
  - **Process**: 제어된 Output을 출력하는 System
  - **Actuator**: Controller의 전기적 신호를 물리적 신호로 변환하는 System
- **센서(Sensor)**: Output을 측정하여 Controller에 피드백하는 장치
- **외란(Disturbance)**: Plant 출력에서 제어되어야 할 신호를 변화시키는 외적 요인
- **센서 노이즈(Sensor Noise)**: 센서 측정에 발생하는 오차

### 폐루프 제어 시스템 흐름도
```
         ┌───────────────────────────────────────────────────┐
         │                                                   │
         │                  Disturbance                       │
         │                       ↓                           │
Reference → (+) → [Controller] → [Actuator] → [Process] → Output
           ↑                                       │
           │                                       │
          (-)←───────────[Sensor]←─────────────────┘
                           ↑
                     Sensor Noise
```

### 폐루프 제어의 특징
- **장점**: 모델이 불확실하고 외란이 존재해도 Control Objective를 만족시킬 수 있음
- **단점**: 추가적인 센서 장착으로 비용 증가, 시스템 복잡성 증가

### 제어 목표(Control Objective)
1. **안정성(Stability)**: 시스템은 항상 안정적이어야 함
2. **추적성(Tracking)**: Output이 Reference를 잘 추적해야 함
3. **외란 제거(Disturbance Rejection)**: 불필요한 외란에 전체 시스템이 민감하게 반응하지 않아야 함
4. **강인성(Robustness)**: Plant가 불안정하고 시간에 따라 변화해도 Output은 Reference를 따라가야 함

## 4. 제어 시스템 설계 과정

1. **Plant의 모델링/분석**
   - System 특성 파악
   - 모델 유도

2. **설계**
   - 문제 설정 (제어 목표)
   - 제어기 설계
   - 모의 시험

3. **구현/적용**
   - 하드웨어/소프트웨어 제작
   - 적용 시험

## 5. 자동차 크루즈 컨트롤 예제

### 문제 정의
- 자동차를 운전자가 지정한 특정 속도로 일정하게 주행시키도록 함

### 시스템 구성 요소
- **기준값(Desired Speed)**: 운전자가 설정한 목표 속도
- **제어기(Controller)**: 속도 오차에 기반하여 조절하는 장치
- **제어 변수(Control Variable)**: 스로틀(Throttle)
- **액추에이터(Actuator)**: 엔진
- **프로세스(Process)**: 자동차 본체
- **센서(Sensor)**: 속도계(Speedometer)
- **외란(Disturbance)**: 도로 경사(Road Grade)
- **센서 노이즈**: 속도계 측정 오차

### 시스템 모델링
주어진 정보:
1. 자동차가 65mph(104km/h)로 평평한 길을 달릴 때, 스로틀 각이 1° 변하면 속도는 10mph 변함
2. 자동차가 언덕을 오르거나 내려올 때, 경사 변화 1%(1% grade)에 따라 5mph씩 속도가 증감
3. 위 관계는 선형(linear)이라 가정

### 모델 표현
```
스로틀 각도(degree) → [10] → 속도(speed)
경사도(% grade) → [5] → 속도(speed)
```

### 개방 루프 크루즈 컨트롤
```
                    % grade
                        ↓w
                      [0.5]
                        ↓
Reference(r) → [1/10] → (+) → [10] → 속도(y)
                        ↑
                        |
                      스로틀
```

수식:
- u = (1/10)r (제어 입력)
- d = u - 0.5w = (1/10)r - 0.5w (스로틀 각도)
- y = 10d = 10((1/10)r - 0.5w) = r - 5w (출력 속도)

결과:
- y가 r을 따라가지만, 외란(w)에 직접적으로 영향을 받음
- Error = r - y = r - (r - 5w) = 5w
- %Error = |기준값 - 측정값|/기준값 × 100 = 5w/r × 100 = 500w/r%

### 폐루프 크루즈 컨트롤
```
                    % grade
                        ↓w
                      [0.5]
                        ↓
Reference(r) → (+) → [10] → (+) → [10] → 속도(y)
               ↑                             |
               |                             |
              (-)←────────────────────────────
```

수식:
- e = r - y (오차)
- u = 10e = 10(r - y) (제어 입력)
- d = u - 0.5w = 10(r - y) - 0.5w (스로틀 각도)
- y = 10d = 10(10(r - y) - 0.5w) = 100r - 100y - 5w
- 101y = 100r - 5w
- y = (100/101)r - (5/101)w

결과:
- y가 r을 완벽하게 따라가지는 않지만(r ≠ y), 외란의 영향이 -5w에서 -(5/101)w로 크게 감소
- Error = r - y = r - ((100/101)r - (5/101)w) = (1/101)r + (5/101)w
- 예: 현재 속도가 65mph일 때 1% 경사를 만나면 %Error = 0.0769%

## 6. 추가 개념: 제어기 종류

### P 제어기(비례 제어, Proportional Controller)
- **정의**: 오차에 비례하는 제어 신호를 생성
- **수식**: u(t) = Kp·e(t)
- **특징**: 
  - 구현이 간단하고 직관적
  - 정상 상태 오차(steady-state error) 존재 가능
  - Kp 값이 클수록 응답이 빨라지지만 오버슈트와 진동 증가

### I 제어기(적분 제어, Integral Controller)
- **정의**: 오차의 적분값에 비례하는 제어 신호를 생성
- **수식**: u(t) = Ki·∫e(t)dt
- **특징**:
  - 정상 상태 오차 제거 가능
  - 응답 속도가 느림
  - 과도한 Ki 값은 오버슈트와 진동 증가

### D 제어기(미분 제어, Derivative Controller)
- **정의**: 오차의 변화율에 비례하는 제어 신호를 생성
- **수식**: u(t) = Kd·(de(t)/dt)
- **특징**:
  - 시스템의 동적 응답 특성 개선
  - 오버슈트 감소
  - 노이즈에 민감하여 단독으로 사용하지 않음

### PID 제어기(비례-적분-미분 제어, Proportional-Integral-Derivative Controller)
- **정의**: P, I, D 제어를 조합한 제어기
- **수식**: u(t) = Kp·e(t) + Ki·∫e(t)dt + Kd·(de(t)/dt)
- **특징**:
  - 세 가지 제어 방식의 장점을 모두 활용
  - 적절한 게인 조정으로 최적의 제어 성능 달성 가능
  - 산업 현장에서 가장 널리 사용되는 제어기

## 7. 추가 개념: 전달함수와 블록선도

### 전달함수(Transfer Function)
- **정의**: 시스템 입력과 출력 사이의 관계를 s-도메인에서 표현한 함수
- **수식**: G(s) = Y(s)/U(s)
- **특징**: 
  - 시스템의 동특성을 간결하게 표현
  - 주파수 응답 분석에 유용
  - LTI 시스템에만 적용 가능

### 블록선도(Block Diagram)
- **정의**: 시스템의 동작을 블록과 신호 흐름으로 시각화한 다이어그램
- **구성 요소**:
  - 블록: 시스템 요소를 나타냄
  - 화살표: 신호의 방향과 흐름을 나타냄
  - 합산점: 신호의 덧셈과 뺄셈을 나타냄
- **블록선도 간소화 규칙**:
  - 직렬 연결: G₁(s)G₂(s)
  - 병렬 연결: G₁(s) + G₂(s)
  - 피드백 연결: G(s)/(1 ± G(s)H(s))

## 8. 추가 개념: 시스템 안정성

### 안정성(Stability)의 정의
- 유한한 입력에 대해 시스템의 출력이 유한하게 유지되는 특성
- 폐루프 시스템에서 특히 중요한 고려사항

### 안정성 판별 방법

#### 1. 특성 방정식(Characteristic Equation)
- **정의**: 폐루프 전달함수의 분모가 0이 되는 방정식
- 모든 근이 s-평면의 왼쪽 반면(LHP)에 있어야 안정

#### 2. 라우스-후르비츠 판별법(Routh-Hurwitz Criterion)
- 특성 방정식의 계수를 이용한 안정성 판별
- 모든 계수가 양수이고, 라우스 배열의 첫 번째 열에 부호 변화가 없어야 안정

#### 3. 근궤적법(Root Locus)
- 시스템 매개변수 변화에 따른 폐루프 극점 위치 변화를 시각화
- 극점이 모두 LHP에 있어야 안정

#### 4. 나이퀴스트 판별법(Nyquist Criterion)
- 주파수 응답을 이용한 안정성 판별
- 나이퀴스트 선도가 (-1,0) 점을 감싸지 않아야 안정 (개루프 전달함수가 안정한 경우)

## 9. 실생활 제어 시스템 예시

### 1. 온도 제어 시스템 (에어컨/히터)
- **개방 루프**: 온도계 없이 에어컨을 설정 온도로 고정
  - 외부 온도 변화에 대응하지 못함
- **폐루프**: 온도 센서로 현재 온도를 측정하고 설정 온도와 비교하여 에어컨 출력 조절
  - 외부 온도 변화에 자동 대응

### 2. 전기 밥솥 온도 제어
- **개방 루프**: 시간에 따라 미리 정해진 전력 공급
- **폐루프**: 온도 센서가 측정한 값을 기반으로 전력 공급 조절
  - 쌀의 양이나 초기 온도에 상관없이 일정한 결과 제공

### 3. 드론의 자세 제어
- **개방 루프**: 모터에 일정한 전력 공급
  - 바람과 같은 외란에 취약
- **폐루프**: 자이로스코프와 가속도계로 현재 자세를 측정하고 목표 자세와 비교하여 각 모터 출력 조절
  - 바람이 불어도 안정적인 자세 유지

### 4. 자동차 ABS (Anti-lock Braking System)
- **개방 루프**: 브레이크 페달을 밟은 만큼 브레이크 압력 적용
  - 바퀴가 잠길 위험
- **폐루프**: 바퀴 회전 속도 센서로 미끄러짐을 감지하고 브레이크 압력을 자동 조절
  - 최적의 제동력과 조향성 유지

## 10. 제어 시스템 설계 시 고려사항

### 1. 성능 지표
- **상승 시간(Rise Time)**: 출력이 목표값의 10%에서 90%까지 도달하는 데 걸리는 시간
- **오버슈트(Overshoot)**: 출력이 목표값을 초과하는 정도
- **정착 시간(Settling Time)**: 출력이 목표값 근처로 수렴하는 데 걸리는 시간
- **정상 상태 오차(Steady-state Error)**: 시간이 충분히 지난 후 남아있는 오차

### 2. 안정성과 성능의 트레이드오프
- 응답 속도를 높이면 오버슈트와 진동이 증가할 수 있음
- 강인성을 높이면 응답 속도가 느려질 수 있음
- 외란 제거 능력을 높이면 노이즈에 민감해질 수 있음

### 3. 센서 선택 고려사항
- 정확도(Accuracy)
- 응답 속도(Response Speed)
- 노이즈 특성(Noise Characteristics)
- 비용(Cost)

### 4. 액추에이터 선택 고려사항
- 출력 범위(Output Range)
- 응답 속도(Response Speed)
- 정밀도(Precision)
- 전력 요구량(Power Requirements)